{
  "swagger": "2.0",
  "info": {
    "title": "AI Doc Formatter API Gateway (Swagger-standardized)",
    "version": "1.0.0",
    "description": "Swagger 2.0 document that standardizes API documentation across the project. This spec uses the /api/v1/auth conventions as the baseline (operationId naming, response envelope, error codes, examples). See the `x-styleguide` extension for contributor guidelines and acceptance criteria.",
    "contact": {}
  },
  "basePath": "/api/v1",
  "schemes": [
    "https",
    "http"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "securityDefinitions": {
    "BearerAuth": {
      "type": "apiKey",
      "name": "Authorization",
      "in": "header",
      "description": "JWT Authorization header using the Bearer scheme. Example: \"Authorization: Bearer {token}\""
    }
  },
  "paths": {
    "/auth/login": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Authenticate user and return JWT token",
        "description": "Validates credentials and returns a JWT access token plus expiry. This endpoint is public and therefore does not require Authorization header.",
        "operationId": "v1.auth.login",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "description": "Login payload",
            "required": true,
            "schema": {
              "$ref": "#/definitions/AuthRequest"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Authentication successful",
            "schema": {
              "$ref": "#/definitions/StandardResponseAuth"
            },
            "examples": {
              "application/json": {
                "success": true,
                "data": {
                  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                  "expiry_unix": 1700000000
                },
                "error": null
              }
            }
          },
          "400": {
            "description": "Bad Request - validation error",
            "schema": {
              "$ref": "#/definitions/StandardResponse"
            }
          },
          "401": {
            "description": "Unauthorized - invalid credentials",
            "schema": {
              "$ref": "#/definitions/StandardResponse"
            }
          },
          "500": {
            "description": "Internal Server Error",
            "schema": {
              "$ref": "#/definitions/StandardResponse"
            }
          }
        },
        "security": []
      }
    },
    "/auth/signup": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Register a new user account",
        "description": "Creates a new user account and returns the created user_id. This endpoint is public.",
        "operationId": "v1.auth.signup",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "description": "Signup payload",
            "required": true,
            "schema": {
              "$ref": "#/definitions/SignupRequest"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "User created",
            "schema": {
              "$ref": "#/definitions/StandardResponseSignup"
            },
            "examples": {
              "application/json": {
                "success": true,
                "data": {
                  "user_id": "f47ac10b-58cc-4372-a567-0e02b2c3d479"
                },
                "error": null
              }
            }
          },
          "400": {
            "description": "Bad Request - validation error",
            "schema": {
              "$ref": "#/definitions/StandardResponse"
            }
          },
          "409": {
            "description": "Conflict - user already exists",
            "schema": {
              "$ref": "#/definitions/StandardResponse"
            }
          },
          "500": {
            "description": "Internal Server Error",
            "schema": {
              "$ref": "#/definitions/StandardResponse"
            }
          }
        },
        "security": []
      }
    }
  },
  "definitions": {
    "AuthRequest": {
      "type": "object",
      "required": [
        "email",
        "password"
      ],
      "properties": {
        "email": {
          "type": "string",
          "format": "email",
          "example": "alice@example.com",
          "description": "User email address"
        },
        "password": {
          "type": "string",
          "minLength": 6,
          "example": "s3cr3tPass",
          "description": "User password (min 6 chars)"
        }
      }
    },
    "SignupRequest": {
      "type": "object",
      "required": [
        "email",
        "password"
      ],
      "properties": {
        "email": {
          "type": "string",
          "format": "email",
          "example": "newuser@example.com",
          "description": "New user email"
        },
        "password": {
          "type": "string",
          "minLength": 6,
          "example": "newuserPass",
          "description": "Password for new user (min 6 chars)"
        }
      }
    },
    "AuthResponse": {
      "type": "object",
      "properties": {
        "access_token": {
          "type": "string",
          "description": "JWT access token"
        },
        "expiry_unix": {
          "type": "integer",
          "format": "int64",
          "description": "Expiry timestamp in unix seconds"
        }
      }
    },
    "SignupResponse": {
      "type": "object",
      "properties": {
        "user_id": {
          "type": "string",
          "format": "uuid",
          "description": "Created user UUID"
        }
      }
    },
    "ErrorResponse": {
      "type": "object",
      "properties": {
        "code": {
          "type": "string",
          "example": "ERR_NOT_FOUND",
          "description": "Machine-readable error code"
        },
        "message": {
          "type": "string",
          "example": "Resource not found",
          "description": "Human-readable error message"
        },
        "details": {
          "type": "object",
          "additionalProperties": true,
          "description": "Optional error details"
        }
      },
      "required": [
        "code",
        "message"
      ]
    },
    "StandardResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean",
          "example": false
        },
        "data": {
          "type": "object",
          "description": "Endpoint-specific payload or null"
        },
        "error": {
          "$ref": "#/definitions/ErrorResponse"
        }
      },
      "required": [
        "success"
      ]
    },
    "StandardResponseAuth": {
      "allOf": [
        {
          "$ref": "#/definitions/StandardResponse"
        },
        {
          "type": "object",
          "properties": {
            "data": {
              "$ref": "#/definitions/AuthResponse"
            }
          }
        }
      ]
    },
    "StandardResponseSignup": {
      "allOf": [
        {
          "$ref": "#/definitions/StandardResponse"
        },
        {
          "type": "object",
          "properties": {
            "data": {
              "$ref": "#/definitions/SignupResponse"
            }
          }
        }
      ]
    }
  },
  "x-styleguide": {
    "summary": "Swagger contributor guidelines & acceptance criteria (applies across /api/v1/* endpoints)",
    "operationIdConvention": "v1.<resource>.<action> (lowercase, dot-separated)",
    "responseEnvelope": "StandardResponse: { success: boolean, data: <payload|null>, error: <ErrorResponse|null> }",
    "errorCodes": [
      "ERR_VALIDATION",
      "ERR_UNAUTHORIZED",
      "ERR_NOT_FOUND",
      "ERR_CONFLICT",
      "ERR_INTERNAL"
    ],
    "authConvention": {
      "securityDefinition": "BearerAuth (Authorization header: 'Bearer {token}')",
      "publicEndpoints": "explicitly set security: []",
      "protectedEndpoints": "include security reference to BearerAuth"
    },
    "examplesRequired": "Each endpoint must include at least one success example and one error example where applicable",
    "componentsReuse": "Use definitions to centralize shared schemas (ErrorResponse, StandardResponse, AuthRequest, etc.)",
    "documentationNotes": "When documenting file uploads, use 'consumes': ['multipart/form-data'] and file param schema type: 'file'. For Swagger 2.0, use 'type: file' for file params."
  },
  "x-acceptance-criteria": {
    "description": "Project-level acceptance criteria for the Swagger standardization effort",
    "items": [
      "All existing /api/v1/* endpoints are reviewed and updated to match operationId convention and response envelope.",
      "Shared response and error schemas exist under definitions and are referenced by paths.",
      "Public endpoints explicitly have empty security. Protected endpoints reference BearerAuth.",
      "Examples provided for request payloads and responses (200/201 and at least one 4xx).",
      "A checklist of updated endpoints is added to the related issue/PR and updated as endpoints are changed.",
      "CI validation (spectral or swagger-cli) should pass for the OpenAPI/Swagger file."
    ]
  },
  "x-checklist": {
    "note": "Populate this checklist in the issue/PR with actual repo endpoints as you update them.",
    "endpoints": [
      {
        "path": "/auth/login",
        "method": "POST",
        "updated": true,
        "notes": "Converted to standard response envelope, added examples, operationId=v1.auth.login"
      },
      {
        "path": "/auth/signup",
        "method": "POST",
        "updated": true,
        "notes": "Converted to standard response envelope, added examples, operationId=v1.auth.signup"
      }
    ]
  }
}
